define(["jquery","core/log"],function(a,b){var c;return{init:function(d){c=d,a("#id-system-mtd-selectall-write").bind("click",this.selectall_system_write),a("#id-indexer-mtd-selectall-write").bind("click",this.selectall_indexer_write),a("#id-author-mtd-selectall-write").bind("click",this.selectall_author_write),a("#id-system-mtd-selectall-read").bind("click",this.selectall_system_read),a("#id-indexer-mtd-selectall-read").bind("click",this.selectall_indexer_read),a("#id-author-mtd-selectall-read").bind("click",this.selectall_author_read),a("#id-system-mtd-selectnone-write").bind("click",this.selectnone_system_write),a("#id-indexer-mtd-selectnone-write").bind("click",this.selectnone_indexer_write),a("#id-author-mtd-selectnone-write").bind("click",this.selectnone_author_write),a("#id-system-mtd-selectnone-read").bind("click",this.selectnone_system_read),a("#id-indexer-mtd-selectnone-read").bind("click",this.selectnone_indexer_read),a("#id-author-mtd-selectnone-read").bind("click",this.selectnone_author_read),a(".mtd-check").bind("change",this.toggle_childs),a(".mtd-parent").bind("init",this.init_parent),a(".mtd-parent").trigger("init"),a(".mtd-widget").bind("rowchange",this.widget_check),b.debug("AMD Mod sharedresource metadata configuration form initialized")},selectall_system_write:function(){a("."+c+"-system-write").prop("checked",!0),a("."+c+"-system-read").prop("checked",!0),a("."+c+"-system-read").prop("disabled",!0)},selectall_system_read:function(){a("."+c+"-system-read").prop("checked",!0)},selectall_indexer_write:function(){a("."+c+"-indexer-write").prop("checked",!0),a("."+c+"-indexer-read").prop("checked",!0),a("."+c+"-indexer-read").prop("disabled",!0)},selectall_indexer_read:function(){a("."+c+"-indexer-read").prop("checked",!0)},selectall_author_write:function(){a("."+c+"-author-write").prop("checked",!0),a("."+c+"-author-read").prop("checked",!0),a("."+c+"-author-read").prop("disabled",!0)},selectall_author_read:function(){a("."+c+"-author-read").prop("checked",!0)},selectnone_system_write:function(){a("."+c+"-system-write").prop("checked",!1),a("."+c+"-system-read").prop("disabled",!1)},selectnone_system_read:function(){a("."+c+"-system-read").prop("checked",!1)},selectnone_indexer_write:function(){a("."+c+"-indexer-write").prop("checked",!1),a("."+c+"-indexer-read").prop("disabled",!1)},selectnone_indexer_read:function(){a("."+c+"-indexer-read").prop("checked",!1)},selectnone_author_write:function(){a("."+c+"-author-write").prop("checked",!1),a("."+c+"-author-read").prop("disabled",!1)},selectnone_author_read:function(){a("."+c+"-author-read").prop("checked",!1)},init_parent:function(){if(that=a(this),regexp=/([^-]*)-([^-]*)-([^-]*)-(.*)$/,matches=that.attr("id").match(regexp)){fieldtype=matches[2],readwrite=matches[3],nodeid=matches[4];var b=that.prop("checked");1==b?a("."+c+"-"+fieldtype+"-"+readwrite+" "+nodeid).prop("disabled",!1):(a("."+c+"-"+fieldtype+"-"+readwrite+" "+nodeid).prop("checked",!1),a("."+c+"-"+fieldtype+"-"+readwrite+" "+nodeid).prop("disabled",!0)),a("."+c+"-widget-"+nodeid).trigger("rowchange")}},toggle_childs:function(){if(b.debug("AMD Mod sharedresource metadata TOGGLE CHILD"),that=a(this),regexp=/([^-]*)-([^-]*)-([^-]*)-(.*)$/,matches=that.attr("id").match(regexp)){var d=matches[2],e=matches[3],f=matches[4],g=[],h=f;if(h=h.replace(/_[^_]+$/,""),h!=f){var i=0;do g.push(h),h=h.replace(/_[^_]+$/,""),i++;while(!h.match(/^\d+$/)&&100>i)}var j=that.prop("checked");if(1==j)for(a("."+c+"-"+d+"-"+e+"-"+f).prop("checked",!0),a("."+c+"-"+d+"-"+e+"-"+f).prop("disabled",!1),"write"==e&&(a("#"+c+"-"+d+"-read-"+f).prop("checked",!0),a("#"+c+"-"+d+"-read-"+f).prop("disabled",!0),a("."+c+"-"+d+"-read-"+f).prop("checked",!0),a("."+c+"-"+d+"-read-"+f).prop("disabled",!0)),parentid=g.shift();parentid;)a("#"+c+"-"+d+"-"+e+"-"+parentid).prop("checked",!0),a("#"+c+"-"+d+"-"+e+"-"+parentid).prop("disabled",!1),"write"==e&&(a("#"+c+"-"+d+"-read-"+parentid).prop("checked",!0),a("#"+c+"-"+d+"-read-"+parentid).prop("disabled",!0)),parentid=g.shift(),b.debug("AMD Mod sharedresource metadata Checking parent");else a("."+c+"-"+d+"-"+e+"-"+f).prop("checked",!1),a("."+c+"-"+d+"-"+e+"-"+f).prop("disabled",!0),"write"==e&&(a("#"+c+"-"+d+"-read-"+f).prop("disabled",!1),a("."+c+"-"+d+"-read-"+f).prop("disabled",!1));a("#"+c+"-widget-"+f).trigger("rowchange")}},widget_check:function(){if(b.debug("AMD Mod sharedresource metadata WIDGET CHECK"),that=a(this),regexp=/([^-]*)-([^-]*)-(.*)$/,(matches=that.attr("id").match(regexp))&&(fieldtype=matches[2],nodeid=matches[3],a("#"+c+"-widget-"+nodeid).length)){var d=a("#"+c+"-system-read-"+nodeid).prop("checked"),e=a("#"+c+"-indexer-read-"+nodeid).prop("checked"),f=a("#"+c+"-author-read-"+nodeid).prop("checked");f||e||d?a("#"+c+"-widget-"+nodeid).prop("disabled",!1):(a("#"+c+"-widget-"+nodeid).prop("checked",!1),a("#"+c+"-widget-"+nodeid).prop("disabled",!0))}}}});